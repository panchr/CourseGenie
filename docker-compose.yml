# docker-compose.yml
# Author: Rushy Panchal
# Date: March 8th, 2017
# Description: Defines services required for Docker with Django.

version: '2'
services:
  # Database (Postgres)
  db:
    image: postgres:9.6.2

  # Primary web server
  web:
    build: .
    command: ['docker/wait-for-it.sh', 'db:5432', '--', 'python', 'manage.py',
      'runserver', '0.0.0.0:8000']
    volumes:
      - .:/server
    ports:
      - "8000:8000"
    links:
      - db
    depends_on:
      - db
    environment:
      - DATABASE_URL=postgres://postgres:postgres@db:5432/postgres
      - CAS_URL=https://cast.cs.princeton.edu/
      - TRANSCRIPT_API_URL=https://transcriptapi.tigerapps.org
